\documentclass{article}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{amsmath, amsfonts}
\usepackage{enumerate}
\usepackage{hyperref}
\usepackage{listings}
\input{title.tex}

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\R}{\mathbb{R}}
\begin{document}
	\maketitle
	\section{}
	We know that
	\begin{equation}
		E(0, (a,b))=(a\cdot_n 0)+_nb=b
    \end{equation}
    and
    \begin{align*}
        E(b, (a,b))
        &=(a\cdot_n b)+_n b\\
        &=(a\cdot b)\mod n+_n b\\
        &=\left[(a\cdot b)\mod n+b\right]\mod n\\
        &=\left[(a\cdot b)+b\right]\mod n\\
        &=\left[a\cdot (b+1)\right]\mod n
        \tag{2}
    \end{align*}
    thus we create an algorithm
    \begin{lstlisting}[mathescape=true]
        b := send(0, 0); // (1)
        d := E(b, (a,b));
        for i$\in\Z_n$ { // bruteforcing a using (2)
            if ((i * (b + 1)) mod n = d) {
                a := i;
                break;
            }
        }
        // We now know a,b
        choose $z_0, z_1\in\Z_n$;
        secret := send($z_0$, $z_1$);
        if D(secret, (a,b)) = $z_0$
            return 0;
        else
            return 1;
    \end{lstlisting}
    \section{}
    We know
    \begin{equation*}
        a|b\rightarrow b=c\cdot a
    \end{equation*}
    thus
    \begin{align*}
        (x\mod b)\mod a
        &=(x\mod c\cdot a)\mod a\\
        &=(n(c\cdot a)+r\mod c\cdot a)\mod a\\
        &=r\mod a\\
        &=q\cdot a+r\mod a&(\underset{q\in\N}\forall)\\
        &=n\cdot c\cdot a+r\mod a\\
        &=x\mod a
    \end{align*}
    \section{}
    \begin{align*}
        \gcd(a\mod b,b)
        &=\underset{c}\max\{c|\underset{\alpha,\beta\in\N}\exists a\mod b=\alpha c\land b=\beta c\}\\
        &=\underset{c}\max\{c|\underset{\alpha,\beta\in\N}\exists qb+r\mod b=\alpha c\land b=\beta c\}\\
        &=\underset{c}\max\{c|\underset{\alpha,\beta\in\N}\exists r=\alpha c\land b=\beta c\}\\
        &=\underset{c}\max\{c|\underset{\alpha,\beta\in\N}\exists qb+r=qb+\alpha c\land b=\beta c\}\\
        &=\underset{c}\max\{c|\underset{\alpha,\beta\in\N}\exists a=q(\beta c)+\alpha c\land b=\beta c\}\\
        &=\underset{c}\max\{c|\underset{\alpha,\beta\in\N}\exists a=(q\beta+\alpha)c\land b=\beta c\}\\
        &=\underset{c}\max\{c|\underset{\alpha,\beta\in\N}\exists a=\alpha' c\land b=\beta c\}\\
        &=\gcd(a,b)
    \end{align*}
\end{document}
